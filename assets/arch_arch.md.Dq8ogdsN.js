import{bV as i,aL as e,u as a,G as n}from"./chunks/framework.SimCp1Tr.js";const k=JSON.parse('{"title":"arch","description":"","frontmatter":{},"headers":[],"relativePath":"arch/arch.md","filePath":"arch/arch.md","lastUpdated":null}'),l={name:"arch/arch.md"};function o(t,s,c,d,p,r){return e(),a("div",null,[...s[0]||(s[0]=[n(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /arch/arch.md for this page in Markdown format</div><h1 id="arch" tabindex="-1">arch <a class="header-anchor" href="#arch" aria-label="Permalink to &quot;arch&quot;">​</a></h1><h4 id="基本系统安装" tabindex="-1">基本系统安装: <a class="header-anchor" href="#基本系统安装" aria-label="Permalink to &quot;基本系统安装:&quot;">​</a></h4><ol><li>进入BIOS，选择UEFI启动</li><li>禁止终端蜂鸣器: <code>rmmod pcspkr</code></li><li>确认是否为UEFI模式:<code>ls /sys/firmware/efi/efivars</code></li><li>联网: <code>iwctl</code>进入交互式，<code>device list</code>查看网卡名，比如wlan0，<code>station wlan0 scan</code>扫描网络，<code>station wlan0 get-networks</code>列出网络，<code>station wlan0 connect wifi-name</code>联网，<code>exit</code>退出，<code>ping bing.com</code>查看是否联网。</li><li>校时: <code>timedatectl set-ntp true</code>，<code>timedatectl status</code>验证是否成功</li><li>换源: <code>vim /etc/pacman.d/mirrorlist</code>，<code>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch # 清华大学开源软件镜像站</code></li><li>转换磁盘为GPT类型:<code>parted /dev/nvme0n1</code>， 输入<code>mktable</code>，然后gpt，yes，最后quit</li><li><code>cfdisk</code>，先建立512MB的EFI分区，再创建大于内存60％的swap分区，最后剩余空间全部分给btrfs系统分区。</li><li>格式化EFI分区:<code>mkfs.fat -F32 /dev/nvme0n1p1</code>，格式化swap分区<code>mkswap /dev/nvme0n1p2</code>，<code>mkfs.btrfs -L myArch /dev/nvme0n1p3</code>。</li><li>创建btrfs子卷:，先挂载btrfs分区到/mnt:， <code>mount -t btrfs -o compress=zstd /dev/nvme0n1p3 /mnt</code>，<code>df -h</code>查看是否挂载成功，<code>btrfs subvolume create /mnt/@ </code> 创建根目录子卷，<code>btrfs subvolume create /mnt/@home</code> 创建home子卷，<code>btrfs subvolume list -p /mnt</code>，查看挂载情况。将/mnt卸载以挂载子卷，<code>umount /mnt</code>。</li><li>挂载各分区和以及子卷<code>mount -t btrfs -o subvol=/@,compress=zstd /dev/nvme0n1p3 /mnt</code> 挂载 / 目录。 <code>mkdir /mnt/home</code> ，创建 /home 目录，<code>mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvmexn1p3 /mnt/home</code> ， 挂载 /home 目录。<code>mkdir -p /mnt/boot</code> # 创建 /boot 目录，<code>mount /dev/nvme0n1p1 /mnt/boot</code> # 挂载 /boot 目录。<code>swapon /dev/nvme0n1p2</code> # 挂载交换分区。<code>df -h</code>查看挂载情况，<code>free -h</code>查看交换分区挂载情况。</li><li>安装基础包和基础软件: <code>pacstrap /mnt base base-devel linux linux-firmware btrfs-progs networkmanager neovim sudo zsh zsh-completions pacman</code>。内核构建可能报<code>file not found: /etc/vconsole.conf</code>，需要手动创建，<code>echo &quot;KEYMAP=us&quot; &gt; /etc/vconsole.conf &amp;&amp; echo &quot;FONT=lat9w-16&quot; &gt;&gt; /etc/vconsole.conf</code></li><li>根据挂载情况生成定义磁盘分区的文件/etc/fstab，<code>genfstab -U /mnt &gt; /mnt/etc/fstab</code>，要确保无误<code>cat /mnt/etc/fstab</code></li><li>切换到新安装的系统，<code>arch-chroot /mnt</code></li><li>设置主机名和时区，<code>nvim /etc/hostname</code>，键入主机名，如tzgml，然后<code>nvim /etc/hosts</code>，输入如下:</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   localhost</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.1.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   tzgml.localdomain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tzgml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="17"><li>设置时区，<code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></li><li>将系统时间同步到硬件时间，<code>hwclock --systohc</code>。</li><li>设置locale，<code>nvim /etc/locale.gen</code>，去掉<code>en_US.UTF-8 UTF-8</code>和<code> zh_CN.UTF-8 UTF-8</code> 注释，然后生成locale: <code>locale-gen</code>，设置locale: <code>echo &#39;LANG=en_US.UTF-8&#39; &gt; /etc/locale.conf</code>，在这里先不能设置中文locale。</li><li><code> passwd root</code>，为root设置密码。</li><li><code>pacman -S amd-ucode</code>安装显卡微码，比如amd。</li><li>安装引导程序，<code>pacman -S grub efibootmgr os-prober</code>，安装grub到efi分区，<code>grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=ARCH</code>，编辑<code>nvim /etc/default/grub</code>，<code>GRUB_CMDLINE_LINUX_DEFAULT=&quot;loglevel=3 nowatchdog quiet module.sig_enforce=0 zswap.enabled=0&quot;</code>。 <code>GRUB_DISABLE_OS_PROBER=false</code>引导win10。禁用子菜单<code>GRUB_DEFAULT_SUBMENU=y</code>，缩短启动时间<code>GRUB_TIMEOUT=0</code>，更改系统名称<code>GRUB_DISTRIBUTOR=&quot;Arch&quot;</code>，最终生成grub配置文件，<code>grub-mkconfig -o /boot/grub/grub.cfg</code></li><li><code>exit</code>退出chroot环境，换到iso中。<code>umount -R /mnt</code>，卸载新分区，拔掉U盘，<code>reboot</code>重启进入arch。第一阶段安装结束。</li></ol><hr><h4 id="系统初始化" tabindex="-1">系统初始化 <a class="header-anchor" href="#系统初始化" aria-label="Permalink to &quot;系统初始化&quot;">​</a></h4><ol><li>重启后进入tty1，先<code>rmmod pcspkr</code>root为账户名，登录后联网: <code>systemctl enable --now NetworkManager</code>设置网络管理器开机自启，禁用systemd-networkd <code>sudo systemctl disable systemd-networkd &amp;&amp; sudo systemctl disable systemd-networkd-wait-online</code>, 在<code>sudo systemctl disable NetworkManager-wait-online.service &amp;&amp; sudo systemctl mask NetworkManager-wait-online.service</code>,然后<code>nmcli dev wifi list </code>用于显示附近的 Wi-Fi ，<code>nmcli dev wifi connect &quot;Wi-Fi名&quot; password &quot;网络密码&quot;</code>联网，然后ping个地址测试。</li><li><code>pacman -Syyu</code>，更新整个系统</li><li>增加普通用户:<code>useradd -m -G wheel -s /bin/bash tzgml</code>，<code>passwd tzgml</code>设置密码，更改sudo设置<code>sudo nvim /etc/sudoers</code>，把<code>%wheel ALL=(ALL:ALL) NOPASSWD: ALL</code>和<code>%sudo ALL=(ALL) NOPASSWD: ALL</code>和<code>ALL ALL=(ALL) NOPASSWD: ALL</code>改成上述模样并取消注释，。然后<code>su tzgml</code>切换到普通用户。</li><li>配置pacman，<code>sudo nvim /etc/pacman.conf</code>，去掉color注释开启彩色输出，然后<code>CleanMethod = KeepCurrent</code>减少缓存包保留，<code>ParallelDownloads = 20</code>开启并行下载, <code>SigLevel= Never</code>禁止校验签名， 最后去掉<code>[multilib]</code>那两行的注释开启32位库支持，末尾添加archlinuxcn源，最后别忘<code>pacman -Syyu</code>:</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[archlinuxcn]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$arch </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 清华大学开源软件镜像站</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="5"><li>在本地信任farseerfc的key，<code>sudo pacman-key --lsign-key &quot;farseerfc@archlinux.org&quot;</code>，然后<code>sudo pacman -Syyu</code>，然后安装<code>sudo pacman -S archlinuxcn-keyring</code>，再<code>sudo pacman -Syyu</code></li><li>安装基础功能包如下:</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sof-firmware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alsa-firmware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alsa-ucm-conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 声音固件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ntfs-3g</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 可识别 NTFS 格式硬盘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wqy-zenhei</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 上文泉驿字体解决大多 wine 应用中文方块的问题</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noto-fonts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noto-fonts-cjk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noto-fonts-emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noto-fonts-extra</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 谷歌开源字体及表情</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yay</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #AUR助手</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ttf-victor-mono-nerd</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #nerd字体zsh主体和nvim的powerline乱码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noto-fonts-emoji</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #解决不显示emoji的问题，如果还不显示，则fc-cache，然后reboot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yay</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ttf-harmonyos-sans</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #鸿蒙字体，解决hcml乱码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman-contrib</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pacman</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bluez</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bluez-utils</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="7"><li>配置桌面环境</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --depth=1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/JaKooLit/Arch-Hyprland.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Arch-Hyprland</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./install.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>git clone https://github.com/LibreGML/ArchConfig.git</code>, 复制sddm主题到<code>/usr/share/sddm/themes</code>,然后<code>sudo nvim /etc/sddm.conf</code>,<code>Current=simple_sddm_2（主题文件夹名）</code>，然后重启服务<code>sudo systemctl restart sddm</code>。<br> 复制grub主题文件到/usr/share/grub/themes, <code>sudo nvim /etc/default/grub</code>, <code>GRUB_THEME=&quot;/usr/share/grub/themes/SekiroShadow/theme.txt&quot;</code>，然后<code>sudo grub-mkconfig -o /boot/grub/grub.cfg</code>。顺便禁用systemd-boot,<code>sudo systemctl disable systemd-boot-update &amp;&amp; sudo systemctl disable systemd-boot-clear-sysfail</code></p><ol><li>安装AMD显卡驱动: <code>sudo pacman -S mesa lib32-mesa xf86-video-amdgpu vulkan-radeon lib32-vulkan-radeon</code></li><li>更改系统语言为中文: <code>sudo nvim /etc/locale.gen</code>，添加<code>zh_CN.UTF-8 UTF-8</code>，然后<code>sudo locale-gen</code>，然后<code>sudo nvim /etc/environment</code>，添加<code>LANG=zh_CN.UTF-8</code>。</li><li><code>sudo nvim /etc/systemd/system.conf</code>，找到<code>DefaultTimeoutStopSec</code>和<code>DefaultTimeoutStartSec</code>，取消注释，值改成0s，然后<code>sudo systemctl daemon-reload</code>，改变开关机被阻碍问题。</li><li><code>sudo nvim /etc/systemd/journald.conf</code>，然后<code>Storage=none</code>，之后<code>sudo journalctl --vacuum-size=0M &amp;&amp; sudo journalctl --vacuum-time=0s</code>，<code>sudo rm -rf /var/log/* &amp;&amp; sudo rm -rf /run/log/journal/*</code>。然后<code>sudo pacman -Scc &amp;&amp; yay -Scc</code>，然后<code>sudo paccache -rk0</code>。</li><li>重启检查，基础系统安装完毕！</li></ol><hr><h4 id="配置代理" tabindex="-1">配置代理 <a class="header-anchor" href="#配置代理" aria-label="Permalink to &quot;配置代理&quot;">​</a></h4><p>v2ray:</p><ol><li>安装v2ray与v2raya:<code>sudo pacman -S v2ray v2raya</code></li><li>设置开机启动并立刻执行，<code>sudo systemctl enable --now v2ray v2raya</code></li><li>打开浏览器进入127.0.0.1:2017</li><li>打开机场，导出订阅，并寻找节点列表</li></ol><ul><li><a href="https://ikuuu.pw/" target="_blank" rel="noreferrer">ikuuuvpn免费50GB/月</a></li><li><a href="https://owo.ecycloud.com/auth/register?code=kApr4ea5GB" target="_blank" rel="noreferrer">ecycloud10GB/月免费</a></li><li>将节点vmess链接复制到v2ray的SERVER中，点击设置，透明代理和规则端口的分流模式选择大陆白名单模式，透明代理实现方式选择tproxy，需要docker则选择redirect。防止DNS污染选择DOH。</li></ul><ol start="5"><li>点击启动，去谷歌测试</li></ol><p>clash:</p><ol><li><code>sudo pacman -S mihomo clash-geoip clash-verge-rev</code></li><li>开启系统代理，Tun模式，局域网连接和ipv6，导入配置文件或链接，点击使用，再去测试里一键测试。</li><li><a href="https://www.glados.rocks/" target="_blank" rel="noreferrer">GLADOS机场</a></li></ol><p>开启代理后，在终端可能需要 <code>export http_proxy=&#39;http://127.0.0.1:7897&#39; &amp;&amp; export https_proxy=&#39;http://127.0.0.1:7897&#39; </code></p><h4 id="更换内核" tabindex="-1">更换内核 <a class="header-anchor" href="#更换内核" aria-label="Permalink to &quot;更换内核&quot;">​</a></h4><ol><li>安装cachyos内核 <code>sudo pacman -S linux-cachyos-rc linux-cachyos-rc-headers</code></li><li>卸载linux原版内核，<code>sudo pacman -Rns linux linux-headers</code></li><li>更新grub配置，<code>sudo grub-mkconfig -o /boot/grub/grub.cfg</code>，这一步一定要有！否则删除旧内核后会进不了系统！如果忘了进入iso，挂载btrfs分区到/mnt，再挂载boot分区到/mnt/boot，然后<code>arch-chroot /mnt</code>，然后<code>grub-mkconfig -o /boot/grub/grub.cfg</code>，然后umount，拔掉U盘reboot。</li><li><code>reboot</code>选择xanmod内核回车进入</li><li>查看当前系统内核 <code>uname -a</code></li></ol><h4 id="配置输入法" tabindex="-1">配置输入法 <a class="header-anchor" href="#配置输入法" aria-label="Permalink to &quot;配置输入法&quot;">​</a></h4><ol><li>安装fcitx:</li></ol><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sudo pacman -S fcitx5 fcitx5-chinese-addons fcitx5-configtool fcitx5-gtk fcitx5-qt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>设置环境变量: <code>sudo nvim /etc/environment</code>，写入:</li></ol><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>GTK_IM_MODULE=fcitx</span></span>
<span class="line"><span>QT_IM_MODULE=fcitx</span></span>
<span class="line"><span>XMODIFIERS=@im=fcitx</span></span>
<span class="line"><span>SDL_IM_MODULE=fcitx</span></span>
<span class="line"><span>GLFW_IM_MODULE=ibus</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li>进入设置，点击语言和区域设置。再点击输入法，点击添加输入法添加拼音，配置拼音，勾选启用云拼音，配置云拼音，后端选择百度，把将嵌入预编辑文本的光标固定在开头那个选项去掉，关闭预测，取消使用V触发快速输入，取消快速输入的触发键。然后去<a href="./&#39;https://pinyin.sogou.com/dict/&#39;">搜狗词库</a> 下载.scel词库，转换为.txt，导入fcitx5。</li><li>之后退出来选择配置全局选项，将切换&quot;启用/禁用输入法&quot;的快捷键换为左shift，应用。</li><li>点击右下角托盘的输入法。右键选择重新启动，之后按左shift或者右键选拼音，测试输入中文。</li><li><code>yay fcitx5-skin-fluentdark-git</code>, 进入fcitx配置界面，点击配置附加组件，配置经典用户界面，把主题换成FluentDark-Solid,再调下字体。</li></ol><h4 id="配置nvim" tabindex="-1">配置nvim <a class="header-anchor" href="#配置nvim" aria-label="Permalink to &quot;配置nvim&quot;">​</a></h4><p><code>cd .local/share</code><code>rm -rf nvim</code><code>cd ~</code><code>cd .config</code><code>git clone</code><code>nvim</code> 之后会自动装插件 后续键入<code>:Mason</code>装插件，输入<code>/</code>开始搜索，键入i下载，X删除，JS推荐使用vtsls</p><h4 id="美化终端" tabindex="-1">美化终端: <a class="header-anchor" href="#美化终端" aria-label="Permalink to &quot;美化终端:&quot;">​</a></h4><ol><li>安装zsh:<code>sudo pacman -Sy zsh</code></li><li>更改默认终端:<code>chsh -s /usr/bin/zsh</code></li><li>安装oh-my-sh: <code>sh -c &quot;$(curl -fsSL https://gitee.com/pocmon/ohmyzsh/raw/master/tools/install.sh)&quot;</code></li><li><code>sudo pacman -S pkgfile</code>, <code>sudo pkgfile -u</code></li><li><code>git clone https://gitee.com/asddfdf/zsh-syntax-highlighting.git \${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting</code></li><li><code>git clone https://gitee.com/chenweizhen/zsh-autosuggestions.git \${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions</code></li><li><code>git clone https://gitee.com/mo2/fzf-tab.git \${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/fzf-tab</code></li><li><code>yay -S pokemon-colorscripts-git</code>,再<code>sudo pacman -S fastfetch figlet lolcat eza bat tree httping</code></li><li>再复制<a href="https://github.com/LibreGML/ArchConfig/blob/master/zshrc" target="_blank" rel="noreferrer">我的.zshrc</a>即可。</li></ol><h4 id="rtl8821网卡驱动" tabindex="-1">RTL8821网卡驱动 <a class="header-anchor" href="#rtl8821网卡驱动" aria-label="Permalink to &quot;RTL8821网卡驱动&quot;">​</a></h4><ol><li><code>sudo nvim /etc/modprobe.d/blacklist-rtw88.conf</code></li><li>写入如下内容： <code>blacklist rtw88_8821ce</code><code>blacklist rtw88_8821c</code><code>blacklist rtw88_pci</code><code>blacklist rtw88_core</code><code>install rtw88_8821ce /bin/false</code><code>install rtw88_8821c /bin/false</code> 再把该文件添加进/etc/mkinitcpio.conf的FILE数组中。</li><li><code>yay -S rtl8821ce-dkms-git</code>安装新驱动</li><li><code>sudo modprobe -r rtw88_8821ce rtw88_8821c rtw88_pci rtw88_core</code>，</li><li><code>sudo mkinitcpio -P</code></li><li>更新grub，重启</li><li><code>lsmod | grep -i 8821</code>验证</li></ol><h4 id="内存与磁盘压缩" tabindex="-1">内存与磁盘压缩 <a class="header-anchor" href="#内存与磁盘压缩" aria-label="Permalink to &quot;内存与磁盘压缩&quot;">​</a></h4><ol><li><p>磁盘压缩 <code>sudo btrfs filesystem defragment -r -v -czstd /</code> 透明压缩。</p></li><li><p>内存压缩</p></li></ol><ul><li><code>pacman -S zram-generator</code></li><li><code>sudo nvim /etc/systemd/zram-generator.conf</code>, 写入如下</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[zram0]</span></span>
<span class="line"><span>zram-size = min(ram / 2, 4096)</span></span>
<span class="line"><span>compression-algorithm = zstd</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>sudo systemctl daemon-reload</code></li><li><code>sudo systemctl start systemd-zram-setup@zram0.service</code></li><li><code>zramctl</code> 查看是否开启。</li></ul><p><code>sudo btrfs filesystem defragment -r -v -czstd /</code> 透明压缩。</p><h4 id="tty显示中文" tabindex="-1">tty显示中文 <a class="header-anchor" href="#tty显示中文" aria-label="Permalink to &quot;tty显示中文&quot;">​</a></h4><ol><li><code>pacman -S kmscon wqy-microhei ttf-dejavu</code></li><li><code>systemctl disable getty@tty1.service &amp;&amp; systemctl enable kmsconvt@tty1.service</code></li><li><code>ln -s /usr/lib/systemd/system/kmsconvt\\@.service /etc/systemd/system/autovt\\@.service</code></li><li><code>sudo nvim /etc/kmscon/kmscon.conf</code>, 键入如下：</li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">font-name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DejaVu</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Sans</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mono,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WenQuanYi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Micro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Hei</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mono</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">font-size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">18</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 其他选项看情况开启</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="优化启动速度" tabindex="-1">优化启动速度 <a class="header-anchor" href="#优化启动速度" aria-label="Permalink to &quot;优化启动速度&quot;">​</a></h4><p>一，无密码登录</p><ol><li><code>groupadd -r nopasswdlogin</code>创建无密码组，<code> gpasswd -a tzgml nopasswdlogin</code>, <code>groups tzgml</code>验证。</li><li><code>sudo nano /etc/pam.d/login</code>， 在顶部添加 <code>auth sufficient pam_succeed_if.so user ingroup nopasswdlogin</code>。</li><li><code>sudo mkdir -p /etc/sddm.conf.d/</code>，<code>sudo nvim /etc/sddm.conf.d/autologin.conf</code>，键入如下内容, 重启后生效：</li></ol><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Autologin]</span></span>
<span class="line"><span>User=tzgml</span></span>
<span class="line"><span>Session=hyprland.desktop</span></span>
<span class="line"><span>Relogin=true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>二， 直接从UEFI启动</p><ul><li><p>语法： <code>sudo efibootmgr --create --disk X --part Y --loader Z --label &quot;Name&quot; --unicode &quot;params&quot;</code></p></li><li><p>其中：</p><ol><li>X 为ESP分区位置，<code>lsblk</code>查看，比如nvme0n1p1</li><li>Y 为ESP分区的分区号，nvme0n1p1的分区号为1</li><li>Z 为引导加载器位置，<code>ls /boot/vmlinuz-*</code>查看，比如<code>/vmlinuz-linux-cachyos-rc</code></li><li>Name 为引导项名称，比如ArchFast</li><li>params 为启动参数，用<code>cat /proc/cmdline</code>查看。root=UUID的值可用<code>sudo blkid /dev/nvme0n1p3</code>查看。initrd可用<code>ls /boot/initramfs-*</code>查看。</li></ol></li><li><p>举例如下：</p></li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> efibootmgr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/nvme0n1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --part</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --loader</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;\\vmlinuz-linux-cachyos-rc&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ArchFast&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --unicode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;root=UUID=fbdcbdc6-7ea8-467d-8c17-627ebf55995a rw rootflags=subvol=@,noatime initrd=\\initramfs-linux-cachyos-rc.img quiet 8250.nr_uarts=0 module.sig_enforce=0 zswap.enabled=0 nowatchdog loglevel=0 tpm_tis.force=0 tpm_tis.interrupts=0 pcie_aspm=force mitigations=off&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="6"><li></li></ol><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/mkinitcpio.conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;INITRD&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MODULES=()</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BINARIES=()</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">FILES=()</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">HOOKS=(base systemd autodetect modconf kms sd-vconsole block filesystems fsck)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">COMPRESSION=&quot;zstd&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">COMPRESSION_OPTIONS=&quot;-1&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">INITRD</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="7"><li><code>sudo mkinitcpio -P</code></li><li><code>efibootmgr</code>查看是否创建，然后重启进入UEFI调整顺序，将ArchFast放在最前面。</li></ol><h4 id="安全配置" tabindex="-1">安全配置 <a class="header-anchor" href="#安全配置" aria-label="Permalink to &quot;安全配置&quot;">​</a></h4><ol><li><code>wget -c https://launchpadlibrarian.net/188958703/safe-rm-0.12.tar.gz</code> , 解压得到safe-rm文件。</li><li><code>sudo mv safe-rm /usr/local/bin/</code>，在.bashrc中添加<code>alias rm=/usr/local/bin/safe-rm</code></li><li><code>sudo nvim /etc/safe-rm.conf</code>配置安全列表。</li></ol>`,60)])])}const m=i(l,[["render",o]]);export{k as __pageData,m as default};
